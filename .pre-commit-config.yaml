ci:
  autoupdate_schedule: quarterly
  skip:
  - shfmt
  - shellcheck
  - hadolint

repos:
- repo: https://github.com/pre-commit/pre-commit-hooks
  rev: v5.0.0
  hooks:
  # Git style
  - id: check-added-large-files
  - id: check-merge-conflict
  - id: check-vcs-permalinks
  - id: forbid-new-submodules
  - id: no-commit-to-branch

  # Common errors
  - id: end-of-file-fixer
  - id: trailing-whitespace
    args: [--markdown-linebreak-ext=md]
    exclude: CHANGELOG.md
  - id: check-yaml
  - id: check-merge-conflict
  - id: check-executables-have-shebangs

  # Cross platform
  - id: check-case-conflict
  - id: mixed-line-ending
    args: [--fix=lf]

  # Non-modifying checks:
  - id: name-tests-test
    files: >-
      ^tests/[^_].*\.py$

  # Security
  - id: detect-aws-credentials
    args:
    - --allow-missing-credentials
  - id: detect-private-key

  # Detect hardcoded secrets
- repo: https://github.com/gitleaks/gitleaks
  rev: v8.24.2
  hooks:
  - id: gitleaks

# Dockerfile
- repo: https://github.com/hadolint/hadolint
  rev: v2.13.1-beta
  hooks:
  - id: hadolint

# YAML
- repo: https://github.com/jumanjihouse/pre-commit-hook-yamlfmt
  rev: 0.2.3
  hooks:
  - id: yamlfmt
    args:
    - --mapping=2
    - --sequence=2
    - --offset=0
    - --width=75
    - --implicit_start

- repo: https://github.com/adrienverge/yamllint.git
  rev: v1.37.0
  hooks:
  - id: yamllint
    types:
    - file
    - yaml
    args:
    - --strict

# JSON5
- repo: https://github.com/pre-commit/mirrors-prettier
  rev: v4.0.0-alpha.8
  hooks:
  - id: prettier
    # https://prettier.io/docs/en/options.html#parser
    files: .json5$

# Bash
- repo: https://github.com/jumanjihouse/pre-commit-hooks
  rev: 3.0.0
  hooks:
  - id: shfmt
    args:
    - -l
    - -i
    - '2'
    - -ci
    - -sr
    - -w
  - id: shellcheck

# Python
- repo: https://github.com/astral-sh/ruff-pre-commit
  rev: v0.11.4
  hooks:
  - id: ruff
    args:
    - --fix
  - id: ruff-format

# - repo: https://github.com/asottile/add-trailing-comma
#   rev: v3.1.0
#   hooks:
#   - id: add-trailing-comma

# - repo: https://github.com/pre-commit/mirrors-autopep8
#   rev: v2.0.4
#   hooks:
#   - id: autopep8
#     args:
#     - -i
#     - --max-line-length=100

# # Usage: http://pylint.pycqa.org/en/latest/user_guide/message-control.html
# - repo: https://github.com/PyCQA/pylint
#   rev: v3.3.3
#   hooks:
#   - id: pylint
#     args:
#     - --disable=import-error   # E0401. Locally you could not have all imports.
#     - --disable=fixme   # W0511. 'TODO' notations.
#     - --disable=logging-fstring-interpolation   # Conflict with "use a single formatting" WPS323
#     # ignore `if TYPE_CHECKING` case. Other do reorder-python-imports
#     - --disable=ungrouped-imports
#     # Similar lines in 2 files. Currently I don't think that it possible
#     # to DRY hooks unique files boilerplate
#     - --disable=R0801

- repo: https://github.com/pre-commit/mirrors-mypy
  rev: v1.14.1
  hooks:
  - id: mypy
    additional_dependencies:
    - types-PyYAML
    args: [--ignore-missing-imports, --disallow-untyped-calls, --warn-redundant-casts]

# - repo: https://github.com/wemake-services/wemake-python-styleguide
#   rev: 1.0.0
#   hooks:
#   - id: wemake-python-styleguide
#     args:
#     - --allowed-module-metadata=__all__   # Default to ''
#     - --max-local-variables=6   # Default to 5
#     - --max-returns=6   # Default to 5
#     - --max-imports=15   # Default to 12
#       # https://wemake-python-stylegui.de/en/latest/pages/usage/violations/index.html
#     - --extend-ignore= E501   <!-- line too long (> 79 characters). Use 100 -->
#       WPS115 <!-- Found upper-case constant in a class. All occurrences are false
#       positive --> WPS226 <!-- Found string literal over-use - append > 3 -->


#     exclude: |
#       (?x)
#         # Ignore deprecated hook
#         (^src/pre_commit_terraform/terraform_docs_replace.py$
#       )


- repo: https://github.com/pre-commit/mirrors-mypy.git
  rev: v1.15.0
  hooks:
  - id: mypy
    alias: mypy-py313
    name: MyPy, for Python 3.13
    additional_dependencies:
    - lxml  # dep of `--txt-report`, `--cobertura-xml-report` & `--html-report`
    - pytest
    - pytest-mock
    args:
    - --python-version=3.13
    - --any-exprs-report=.tox/.tmp/.test-results/mypy--py-3.13
    - --cobertura-xml-report=.tox/.tmp/.test-results/mypy--py-3.13
    - --html-report=.tox/.tmp/.test-results/mypy--py-3.13
    - --linecount-report=.tox/.tmp/.test-results/mypy--py-3.13
    - --linecoverage-report=.tox/.tmp/.test-results/mypy--py-3.13
    - --lineprecision-report=.tox/.tmp/.test-results/mypy--py-3.13
    - --txt-report=.tox/.tmp/.test-results/mypy--py-3.13
    pass_filenames: false
  - id: mypy
    alias: mypy-py311
    name: MyPy, for Python 3.11
    additional_dependencies:
    - lxml  # dep of `--txt-report`, `--cobertura-xml-report` & `--html-report`
    - pytest
    - pytest-mock
    args:
    - --python-version=3.11
    - --any-exprs-report=.tox/.tmp/.test-results/mypy--py-3.11
    - --cobertura-xml-report=.tox/.tmp/.test-results/mypy--py-3.11
    - --html-report=.tox/.tmp/.test-results/mypy--py-3.11
    - --linecount-report=.tox/.tmp/.test-results/mypy--py-3.11
    - --linecoverage-report=.tox/.tmp/.test-results/mypy--py-3.11
    - --lineprecision-report=.tox/.tmp/.test-results/mypy--py-3.11
    - --txt-report=.tox/.tmp/.test-results/mypy--py-3.11
    pass_filenames: false
  - id: mypy
    alias: mypy-py39
    name: MyPy, for Python 3.9
    additional_dependencies:
    - lxml  # dep of `--txt-report`, `--cobertura-xml-report` & `--html-report`
    - pytest
    - pytest-mock
    args:
    - --python-version=3.9
    - --any-exprs-report=.tox/.tmp/.test-results/mypy--py-3.9
    - --cobertura-xml-report=.tox/.tmp/.test-results/mypy--py-3.9
    - --html-report=.tox/.tmp/.test-results/mypy--py-3.9
    - --linecount-report=.tox/.tmp/.test-results/mypy--py-3.9
    - --linecoverage-report=.tox/.tmp/.test-results/mypy--py-3.9
    - --lineprecision-report=.tox/.tmp/.test-results/mypy--py-3.9
    - --txt-report=.tox/.tmp/.test-results/mypy--py-3.9
    pass_filenames: false
